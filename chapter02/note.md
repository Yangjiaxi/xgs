# Chapter 02 模型评估与选择

---

## 2.1 经验误差与过拟合

1. 训练误差/经验误差：学习器在训练集上的误差
2. 泛化误差：学习器在新样本上的误差
3. 显然，我们希望得到泛化误差小的学习器
4. 过拟合：学习器能力过强，把训练样本自身的一些特点当做潜在样本具有的一般性质，[难克服]
5. 欠拟合：学习器能力过弱，[易克服]

---

## 2.2 评估方法

- 为什么要划分数据集，为什么测试集不能与训练集相交？

  因为使用训练集中的样本来测试学习器，会得到过于乐观的结果。

  所以要对数据集D进行合理划分，得到训练集S和测试集T。

### 2.2.1 留出法

- 直接划分D，$D=S\cup T,S\cap T=\emptyset$
- 划分尽可能保持数据分布的一致性
- 留出法应当多次使用，N次实验后的平均作为评价结果
- 缺点：当数据集较小时无法准确反映学习器的性能
- [一般而言，测试集至少应含30个样例]

### 2.2.2 交叉验证法

- 将D划分为k个大小相似的[互斥]子集

  $D=D_{1}\cup D_{2}\cup ... \cup D_{k},\quad D_{i}\cap D_{j}=\emptyset(i\not=j)$

- 常用的k值是10 : 10折交叉验证

- 进行k次验证：

  - 使用除$D_{k}$外的$k-1$个子集进行训练
  - 使用$D_{k}$检验

- 划分方法可能造成误差，所以要使用p种划分方法 -> p次k折验证

- 总检验次数：$p*k$

- `EXTRA`:留一法(Leave-One-Out : LOO)

  - $|D|=m, k=m$，得到m个单元素子集
  - 优于训练集与样本原集仅相差一个元素，所以留一法的评估结果往往被认为比较准确
  - 当m较大时，时间开销难以忍受[主要缺点]

### 2.2.3 自助法

- 给定包含m个样本的数据集D
- 对D采样产生数据集`D'`
  - 从D中随机挑选一个元素，拷贝后放入`D'`
  - 重复动作m次
- m次操作后，必有元素多次出现，必有元素始终未出现
- 得到数据集`D'`，就是自助采样的结果
- 分析：
  - m个元素，每个元素每次被选到的概率是$\frac{1}{m}$，故不被选到的概率是$1-\frac{1}{m}$
  - 故m次抽取始终不被选到的概率是$(1-\frac{1}{m})^{m}$
  - 取极限${\lim_{m \to \infty}(1-\frac{1}{m})^{m}} \to \frac{1}{e} \approx 0.368 \approx \frac{1}{3}$
  - 我们有数据总量约1/3的、没在训练集中出现的样本能用于测试[包外估计]
- 在数据集较小、难以划分时，自助法很有用

### 2.2.4 调参与最终模型

- 很多强大的学习算法有不少参数需要设定
- 很多时候，参数调得好不好对最终模型性能有关键性影响
- 对于包含m个样本的数据集$D$，使用S训练，T测试。待模型选择完成后，应使用$D$整体重新训练模型，结果作为最终模型
- 称呼
  - 学得模型在实际使用中遇到的数据：测试数据
  - 用于评估与选择的数据集：验证集(T集)

---

## 2.3 性能度量

为评估学习器`f`的性能，就要把学习器预测结果`f(x)`与真实标记`y`进行比较

- 对于离散数据集$D$，最常用的性能度量是“均方误差”
  $$
  E(f;D)=\frac{1}{m}{\sum_{i=1}^{m}(f(\boldsymbol{x}_{i})-y_{i})^2}
  $$



- 更一般的，对于数据服从分布$\mathcal{D}$和概率密度函数$p(\cdot)$，均方误差可描述为

$$
E(f;\mathcal{D})=\int_{\boldsymbol{x\sim \mathcal{D}}}(f(\boldsymbol{x})-y)^2p(\boldsymbol{x})d\boldsymbol{x}
$$

### 2.3.1 错误率与精度

- 对于离散的数据，样例集$D$分类的错误率定义为
  $$
  E(f;D)=\frac{1}{m}{\sum_{i=1}^{m}\mathbb{I}(f(\boldsymbol{x}_{i})\not= y_{i})}
  $$
  精度则定义为
  $$
  acc(f;D)=\frac{1}{m}{\sum_{i=1}^{m}\mathbb{I}(f(\boldsymbol{x}_{i})= y_{i})}\\
  = 1 - E(f;D)
  $$



- 更一般的，对于数据分布服从$\mathcal{D}​$和概率密度函数$p(\cdot)​$，错误率和精度可分别描述为
  $$
  E(f;\mathcal{D})=\int_{\boldsymbol{x\sim \mathcal{D}}}\mathbb{I}(f(\boldsymbol{x})\not= y)p(\boldsymbol{x})d\boldsymbol{x}
  \\
  acc(f;\mathcal{D})=\int_{\boldsymbol{x\sim \mathcal{D}}}\mathbb{I}(f(\boldsymbol{x})= y)p(\boldsymbol{x})d\boldsymbol{x}\\
  =1-E(f;\mathcal{D})
  $$
